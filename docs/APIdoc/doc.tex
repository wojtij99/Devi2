\documentclass[a4paper, 12pt]{report}

\usepackage[T1]{fontenc}
\usepackage[english]{babel}
\usepackage{xcolor}
\usepackage{sectsty}
\usepackage{tabularx}
\usepackage{listings}
\usepackage{verbatim}
\usepackage{hyperref}

\definecolor{chapter_c}{rgb}{0.5, 0.0, 0.0}
\definecolor{section_c}{rgb}{0.64, 0.0, 0.0}
\definecolor{subsection_c}{rgb}{0.74, 0.0, 0.0}
\definecolor{redText}{rgb}{0.9, 0.0, 0.0}

\chapterfont{\color{chapter_c}}
\sectionfont{\color{section_c}}
\subsectionfont{\color{subsection_c}}

\definecolor{keycolor}{HTML}{569CD6}
\definecolor{valuecolor}{HTML}{FF0000}

\hypersetup{
    colorlinks,
    citecolor=blue,
    filecolor=blue,
    linkcolor=blue,
    urlcolor=blue
}

\begin{comment}
\lstdefinelanguage{js}{
  keywords={type,image,changes, CMD, WORKDIR, EXPOSE, builders, commit},
  keywordstyle=\color{keycolor}\bfseries,
  keywords=[2]{test},
  keywordstyle=[2]\color{valuecolor}\bfseries,
  sensitive=false,
  morecomment=[s]{/*}{*/}
}
\end{comment}

\definecolor{delim}{RGB}{20,105,176}
\definecolor{numb}{RGB}{106, 109, 32}
\definecolor{string}{rgb}{0.64,0.08,0.08}

\lstdefinelanguage{json}{
    numbers=left,
    numberstyle=\small,
    frame=single,
    rulecolor=\color{black},
    showspaces=false,
    showtabs=false,
    breaklines=true,
    postbreak=\raisebox{0ex}[0ex][0ex]{\ensuremath{\color{gray}\hookrightarrow\space}},
    %breakatwhitespace=true,
    basicstyle=\ttfamily\small,
    upquote=true,
    morestring=[b]",
    stringstyle=\color{string},
    literate=
     *{0}{{{\color{numb}0}}}{1}
      {1}{{{\color{numb}1}}}{1}
      {2}{{{\color{numb}2}}}{1}
      {3}{{{\color{numb}3}}}{1}
      {4}{{{\color{numb}4}}}{1}
      {5}{{{\color{numb}5}}}{1}
      {6}{{{\color{numb}6}}}{1}
      {7}{{{\color{numb}7}}}{1}
      {8}{{{\color{numb}8}}}{1}
      {9}{{{\color{numb}9}}}{1}
      {\{}{{{\color{delim}{\{}}}}{1}
      {\}}{{{\color{delim}{\}}}}}{1}
      {[}{{{\color{delim}{[}}}}{1}
      {]}{{{\color{delim}{]}}}}{1},
}

\lstset{
   language=json,
   frame=single,
   extendedchars=true,
   basicstyle=\footnotesize\ttfamily,
   showstringspaces=false,
   showspaces=false,
   tabsize=2,
   breaklines=true,
   showtabs=false
}

\begin{document}

\title{\Large{\textbf{DEVI project}}}
\author{Wojciech JÄ™drzejewski}

\maketitle

\tableofcontents

\chapter{Introduction}

\chapter{Database}

\chapter{Error pages}
\section{Error 418 Teapot}
\textbf{route: \color{redText} /teapot} \\
This error shows up when the HTCPCP requests returns an error.

\chapter{DEVI Queries}
\section{Description}

\chapter{Sheets Module}
\section{Description}

\chapter{Pages Module}
\section{Description}
Graphical representation of data or forms to insert.

\section{Table}
\subsection{table}
\textbf{\color{redText} Description} \\
Table with limited amount of columns.\\
{\color{redText} This component cannot be combined with any other!}\\
\textbf{\color{redText} Body parameters} \\
\textbf{columns:} column to show, If you put '*' show all columns\\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "columns": [
            "name",
            "price",
            "category" 
            ]
    }
\end{lstlisting}
\subsection{extendedTable}
\textbf{\color{redText} Description} \\
Table with limited amount of columns and after click row it's redirects to another page. \\
{\color{redText} This component cannot be combined with any other!}\\
\textbf{\color{redText} Body parameters} \\
\textbf{columns:} column to show, If you put '*' show all columns\\
\textbf{onRowClick:} target page\\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "columns": [
            "name",
            "lastName",
            "addres"
            ],
        "onRowClick": "clientView"
    }
\end{lstlisting}
\section{Forms}
% \subsection{textInput}
% \textbf{\color{redText} Description} \\
% Text input. \\
% \textbf{\color{redText} Body parameters} \\
% \textbf{column:} \\
% \textbf{\color{redText} Example body: }
% \begin{lstlisting}
%     {
%         "columns": [
%             "name",
%             "lastName",
%             "addres"
%             ],
%         "onRowClick": "clientView"
%     }
% \end{lstlisting}
\section{Views}
\chapter{Commands}
\section{Admin}
Commands to administrate system. \textbf{NOT for user!}

\subsection{/admin/addNewCompany}


\textbf{\color{redText} Description} \\
Add new company to system. \\ \\
\textbf{\color{redText} METHOD: } \textbf{PUT} \\
\textbf{\color{redText} Body parameters} \\
\textbf{name: } name of company and database \\
\textbf{email: } company email \\
\textbf{user: } user name for first user \\
\textbf{pass: } password for first user \\
\textbf{key: } admin key \\
\textbf{\color{redText} Return: } NULL \\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "name": "myCompany",
        "email": "mycompanygmail.com",
        "user": "admin",
        "pass": "1qazXSW@",
        "key": "<PASTEadminKEYhere>"
    }
\end{lstlisting}

\section{SIN}
\textbf{SIN} (\textbf{S}ecurry \textbf{I}ndentyfication \textbf{N}umber) - token to indentyfication user. It store user ip, user browser agent, user name and DB name.
This number have 5 minutes time of live. Every call of \textbf{/getSIN} extends this time by next 5 minutes.
You may have only one SIN per user.
\subsection{/getSIN}
\textbf{\color{redText} Description} \\
Get SIN from server or when you have it extend it expire time. \\
\textbf{\color{redText} METHOD: } \textbf{POST} \\
\textbf{\color{redText} Haeder parameters} \\
\textbf{User-Agent: } browser name (It's automaticly added by our browser)\\
\textbf{\color{redText} Body parameters} \\
\textbf{user: } user name\\
\textbf{pass: } user password\\
\textbf{db: } admin key \\
\textbf{\color{redText} Return: }\\
\textbf{sin: } your SIN \\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "user": "admin",
        "pass": "1qazXSW@",
        "db": "myCompany"
    }
\end{lstlisting}
\textbf{\color{redText} Example response: }
\begin{lstlisting}
    {
        "sin": "<yourSIN>"
    }
\end{lstlisting}

\subsection{/dropSIN}
\textbf{\color{redText} Description} \\
Drop your SIN from server. It work like logout. \\
\textbf{\color{redText} METHOD: } \textbf{DELETE} \\
\textbf{\color{redText} Body parameters} \\
\textbf{SIN: } SIN number\\
\textbf{\color{redText} Return: } NULL \\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "sin": "<yourSIN>"
    }
\end{lstlisting}

\section{Tables}

\subsection{/tables}
\textbf{\color{redText} Description} \\
Returns the names of all tables. \\
\textbf{\color{redText} METHOD: } \textbf{POST} \\
\textbf{\color{redText} Body parameters} \\
\textbf{SIN: } SIN number\\
\textbf{\color{redText} Return: } \\
\textbf{tables: } array with tables names \\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "sin": "<yourSIN>"
    }
\end{lstlisting}
\textbf{\color{redText} Example response: }
\begin{lstlisting}
    {
        "tables": [
            "clients",
            "employees",
            "products"
            ]
    }
\end{lstlisting}

\subsection{/tables/add}
\textbf{\color{redText} Description} \\
Add new table. \\
Name parameter cannot start with "log\_" or "system\_" or "dic\_"\\
\textbf{\color{redText} METHOD: } \textbf{PUT} \\
\textbf{\color{redText} Body parameters} \\
\textbf{name: } table name\\
\textbf{SIN: } SIN number\\
\textbf{\color{redText} Return: } NULL \\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "name": "suppliers",
        "sin": "<yourSIN>"
    }
\end{lstlisting}

\subsection{/tables/<table>/addColumn}
\textbf{\color{redText} Description} \\
Add new column to table. \\
'ID' id not allowed name of column.\\
Allowed types: 
\begin{itemize}
    \item INT - intiger 
    \item TEXT - text 
    \item DATETIME - date and time 
    \item TIME - time
    \item DATE - date
    \item FLOAT - floating point number
    \item BOOL - true/false value
    \item KEY - key for relations with other table
\end{itemize}
\textbf{\color{redText} METHOD: } \textbf{PUT} \\
\textbf{\color{redText} URL parameters} \\
\textbf{table: } table name\\
\textbf{\color{redText} Body parameters} \\
\textbf{name: } column name\\
\textbf{type: } column type.\\
\textbf{SIN: } SIN number\\
\textbf{*reference: } name table of reference. Only for KEY \\
\textbf{*} - optional \\
\textbf{\color{redText} Return: } NULL \\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "name": "price",
        "type": "INT",
        "sin": "<yourSIN>"
    }
\end{lstlisting}
\begin{lstlisting}
    {
        "name": "client",
        "type": "KEY",
        "references": "clients",
        "sin": "<yourSIN>"
    }
\end{lstlisting}

\subsection{/tables/<table>/insert}
\textbf{\color{redText} Description} \\
Insert new row into table\\
\textbf{\color{redText} METHOD: } \textbf{PUT} \\
\textbf{\color{redText} URL parameters} \\
\textbf{table: } table name\\
\textbf{\color{redText} Body parameters} \\
\textbf{data: } assoc array key is named like column\\
\textbf{SIN: } SIN number\\
The name of the column you are inserting the value into is name of parameter. You can insert more than one value, but only one row. Values you do not send will be set to NULL.\\
\textbf{\color{redText} Return: } NULL \\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "data":
        {
            "name": "Bob",
            "lastName": "Smith",
            "phone": "123987465"
        },
        "sin": "<yourSIN>"
    }
\end{lstlisting}

\subsection{/tables/<table>/update/<columnID>}
\textbf{\color{redText} Description} \\
Update row. \\
\textbf{\color{redText} METHOD: } \textbf{POST} \\
\textbf{\color{redText} URL parameters} \\
\textbf{table: } table name\\
\textbf{columnID: } column ID\\
\textbf{\color{redText} Body parameters} \\
\textbf{SIN: } SIN number\\
\textbf{data: } assoc array key is named like column\\
%\textbf{Name of cell you update is name of parameter}\\
\textbf{\color{redText} Return: } NULL \\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "data":
        {
            "name": "Bob",
            "lastName": "Smith",
            "phone": "987123456"
        },
        "sin": "<yourSIN>"
    }
\end{lstlisting}

\subsection{/tables/<table>/delete/<columnID>}
\textbf{\color{redText} Description} \\
Delete row. \\
\textbf{\color{redText} METHOD: } \textbf{DELETE} \\
\textbf{\color{redText} URL parameters} \\
\textbf{table: } table name\\
\textbf{columnID: } column ID\\
\textbf{\color{redText} Body parameters} \\
\textbf{SIN: } SIN number\\
\textbf{\color{redText} Return: } NULL \\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "sin": "<yourSIN>"
    }
\end{lstlisting}

\subsection{/tables/<table>/select/<columnID>}
\textbf{\color{red} OUTDATED}\\
\textbf{\color{redText} Description} \\
Select row. \\
\textbf{\color{redText} METHOD: } \textbf{POST} \\
\textbf{\color{redText} URL parameters} \\
\textbf{table: } table name\\
\textbf{columnID: } column ID\\
\textbf{\color{redText} Body parameters} \\
\textbf{SIN: } SIN number\\
\textbf{\color{redText} Return: } 
\textbf{Name of cell is name of parameter}\\

\subsection{/tables/<table>/select/all}
\textbf{\color{redText} Description} \\
Select all row from table. \\
\textbf{\color{redText} METHOD: } \textbf{POST} \\
\textbf{\color{redText} URL parameters} \\
\textbf{table: } table name\\
\textbf{\color{redText} Query parameters} \\
\textbf{*limit: } records per page \\
\textbf{*page: } page number \\
\textbf{*orderBy: } column name \\
\textbf{*orderType: } ASC/DESC \\
\textbf{*} - optional \\
\textbf{\color{redText} Body parameters} \\
\textbf{SIN: } SIN number\\
\textbf{*query: } array: key - column name; value - your parameter \\
\textbf{\color{redText} Return: } \\
\textbf{Legend: } array contain name of all colums \\
\textbf{Types: } array contain type of all colums. Each value is array with values order like columns at Legend parameter. \\
\textbf{Next parameters name 'row' and it number (starts from 0). Each value is array with values order like columns at Legend parameter.}\\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "sin": "<yourSIN>"
    }
\end{lstlisting}
\begin{lstlisting}
    {
        "query":
        {
            "name": "Bob",
            "lastName": "Smith"
        },
        "sin": "<yourSIN>"
    }
\end{lstlisting}
\textbf{\color{redText} Example response: }
\begin{lstlisting}
    {
        "Legend": [
            "name",
            "lastName",
            "phone"
        ],
        "Types": [
            "TEXT",
            "TEXT",
            "INT"
        ],
        "row0":[
            "Bob",
            "Smith",
            "123098822"
        ],
        "row1":[
            "Anna",
            "Smith",
            "123788822"
        ],
        "row2":[
            "Bob",
            "Smith",
            "111222333"
        ],
        "row4":[
            "Tom",
            "White",
            "111222333"
        ],
    }
\end{lstlisting}

\subsection{/tables/<table>/alter}
\textbf{\color{redText} Description} \\
Change name and type of column. \\
\textbf{\color{redText} METHOD: } \textbf{POST} \\
\textbf{\color{redText} URL parameters} \\
\textbf{table: } table name\\
\textbf{\color{redText} Body parameters} \\
\textbf{name: } actual name of column\\
\textbf{newName: } new name of column. If you would not change name send actual\\
\textbf{newType: } new type of column. If you would not change type send actual\\
\textbf{SIN: } SIN number\\
\textbf{\color{redText} Return: } NULL\\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "name": "pirec",
        "newName": "price",
        "newType": "INT",
        "sin": "<yourSIN>"
    }
\end{lstlisting}

\subsection{/tables/<table>/rename}
\textbf{\color{redText} Description} \\
Rename table. \\
\textbf{\color{redText} METHOD: } \textbf{POST} \\
\textbf{\color{redText} URL parameters} \\
\textbf{table: } table name\\
\textbf{\color{redText} Body parameters} \\
\textbf{name: } new name of table\\
\textbf{SIN: } SIN number\\
\textbf{\color{redText} Return: } NULL\\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "name": "products",
        "sin": "<yourSIN>"
    }
\end{lstlisting}

\subsection{/tables/<table>/dropColumn}
\textbf{\color{redText} Description} \\
Delete column. \\
\textbf{\color{redText} METHOD: } \textbf{DELETE} \\
\textbf{\color{redText} URL parameters} \\
\textbf{table: } table name\\
\textbf{\color{redText} Body parameters} \\
\textbf{name: } name of column\\
\textbf{SIN: } SIN number\\
\textbf{\color{redText} Return: } NULL\\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "name": "phone",
        "sin": "<yourSIN>"
    }
\end{lstlisting}

\subsection{/tables/<table>/dropTable}
\textbf{\color{redText} Description} \\
Delete table. \\
\textbf{\color{redText} METHOD: } \textbf{DELETE} \\
\textbf{\color{redText} URL parameters} \\
\textbf{table: } table name\\
\textbf{\color{redText} Body parameters} \\
\textbf{SIN: } SIN number\\
\textbf{\color{redText} Return: } NULL\\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "sin": "<yourSIN>"
    }
\end{lstlisting}

%\subsection{/tables/Dictionaries}
\subsection{/tables/DictionariesAdd}
\textbf{\color{redText} Description} \\
Add dictionares table. \\
\textbf{\color{redText} METHOD: } \textbf{PUT} \\
\textbf{\color{redText} Body parameters} \\
\textbf{name: } table name\\
\textbf{SIN: } SIN number\\
\textbf{\color{redText} Return: } NULL\\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "name": "status",
        "sin": "<yourSIN>"
    }
\end{lstlisting}

\section{Search}
\subsection{/search/<phrase>}
\textbf{\color{redText} Description} \\
Search phrase in all tables. \\
\textbf{\color{redText} METHOD: } \textbf{POST} \\
\textbf{\color{redText} URL parameters} \\
\textbf{phrase: } phrase\\
\textbf{\color{redText} Body parameters} \\
\textbf{SIN: } SIN number\\
\textbf{\color{redText} Return: } \\
Returning array named as table contaning data like /tables/<table>/select/all
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "sin": "<yourSIN>"
    }
\end{lstlisting}
\textbf{\color{redText} Example response: }
\begin{lstlisting}
    {
        "clients":{
            "Legend": [
                "name",
                "lastName",
                "phone"
            ],
            "Types": [
                "TEXT",
                "TEXT",
                "INT"
            ],
            "row0":[
                "Bob",
                "Smith",
                "123098822"
            ],
            "row2":[
                "Bob",
                "Smith",
                "111222333"
            ]
        },
        "suppliers":{
            "Legend": [
                "name",
                "lastName",
                "phone",
                "company",
                "email"
            ],
            "Types": [
                "TEXT",
                "TEXT",
                "INT"
            ],
            "row0":[
                "Bob",
                "Smith",
                "123098822",
                "superFactory",
                "contact@superFactory.com"
            ]
        },
    }
\end{lstlisting}


\section{Client}
Commands for managing client account

\subsection{/client/addAccount}
\textbf{\color{redText} Description} \\
Add new account. \textbf{It work only when you have 'ACCOUNT' privilege}\\
Available privileges:
\begin{itemize}
    \item READ    - you can read data (G,T,S,P)
    \item UPADTE  - you can update data (G,T,S)
    \item DELETE  - you can delete data (G,T)
    \item MODIFY  - you can modify structure of table (when it is global privilege you can also create table) (G,P)
    \item ACCOUNT - you can create and manage accounts (only in global section) (G)
    \item NONE    - you do not have any privilege (G,T,S,P)
    \item ALL     - you do not have all privilege (G,T,S,P)
\end{itemize}
\textbf{\color{redText} METHOD: } \textbf{PUT} \\
\textbf{\color{redText} Body parameters} \\
\textbf{name: } name for new account\\
\textbf{pass: } password for new account\\
\textbf{permissions: } permissions for new account\\
\textbf{SIN: } SIN number\\
\textbf{\color{redText} Return: } NULL\\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "name": "bob",
        "pass": "@WSXzaq1",
        "permissions": {
            "global": ["READ"],
            "tables": {
                "clients": ["ALL"],
                "suppliers": ["READ", "UPADTE", "DELETE"],
                "employees": ["READ"],
                "bosses": ["NONE"]
            },
            "sheets":{
                "sheet1": ["READ", "UPADTE"]
            },
            "pages":{
                "addClient": ["READ"]
            }
        },
        "sin": "<yourSIN>"
    }
\end{lstlisting}

\subsection{/client/changeName}
\textbf{\color{redText} Description} \\
Changing name for your. \textbf{After executing this command you will be logged out!} \\
\textbf{\color{redText} METHOD: } \textbf{POST} \\
\textbf{\color{redText} Body parameters} \\
\textbf{name: } new name for your account\\
\textbf{SIN: } SIN number\\
\textbf{\color{redText} Return: } NULL\\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "name": "bob",
        "sin": "<yourSIN>"
    }
\end{lstlisting}

\subsection{/client/changePass}
Changing password for your. \textbf{After executing this command you will be logged out!} \\
\textbf{\color{redText} METHOD: } \textbf{POST} \\
\textbf{\color{redText} Body parameters} \\
\textbf{pass: } new password for your account\\
\textbf{SIN: } SIN number\\
\textbf{\color{redText} Return: } NULL\\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "pass": "@WSXzaq1",
        "sin": "<yourSIN>"
    }
\end{lstlisting}

\section{Sheet}
\subsection{/sheets}
\textbf{\color{redText} Description} \\
Returns the names of all sheets. \\
\textbf{\color{redText} METHOD: } \textbf{POST} \\
\textbf{\color{redText} Body parameters} \\
\textbf{SIN: } SIN number\\
\textbf{\color{redText} Return: } \\
\textbf{tables: } array with sheets names \\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "sin": "<yourSIN>"
    }
\end{lstlisting}
\textbf{\color{redText} Example response: }
\begin{lstlisting}
    {
        "sheets": [
            "clients",
            "employees",
            "products"
        ]
    }
\end{lstlisting}

\subsection{/sheets/<sheet>/rename}
\textbf{\color{redText} Description} \\
Rename sheet. \\
\textbf{\color{redText} METHOD: } \textbf{POST} \\
\textbf{\color{redText} URL parameters} \\
\textbf{sheet: } sheet name\\
\textbf{\color{redText} Body parameters} \\
\textbf{name: } newName\\
\textbf{SIN: } SIN number\\
\textbf{\color{redText} Return: } NULL \\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "name": "newName",
        "sin": "<yourSIN>"
    }
\end{lstlisting}
\textbf{\color{redText} Example response: }

\subsection{/sheet/<sheet>/update}
Update cell in sheet.\\
\textbf{\color{redText} METHOD: } \textbf{POST} \\
\textbf{\color{redText} URL parameters} \\
\textbf{sheet: } sheet name\\
\textbf{\color{redText} Body parameters} \\
\textbf{coord: } coordinate of cell\\
\textbf{value: } cell value\\
\textbf{SIN: } SIN number\\
\textbf{\color{redText} Return: } NULL\\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "coord": "A2",
        "value": "=SUM(`products`.`price`)";
        "sin": "<yourSIN>"
    }
\end{lstlisting}

\subsection{/sheet/<sheet>/get}
Get sheet with resolved DB functions.\\
\textbf{\color{redText} METHOD: } \textbf{POST} \\
\textbf{\color{redText} URL parameters} \\
\textbf{sheet: } sheet name\\
\textbf{\color{redText} Body parameters} \\
\textbf{SIN: } SIN number\\
\textbf{\color{redText} Return: } \\
\textbf{data: } array contain calculated values from DB\\
\textbf{sheet: } array contain all cells\\
\textbf{\color{redText} Example body: }
\begin{lstlisting}
    {
        "sin": "<yourSIN>"
    }
\end{lstlisting}

\begin{lstlisting}
    {
        "data": {
            "SUM(`products`.`price`)": 1353.5,
            "SUM_IF(`products`.`price`,<100)": 630.4,
            "COUNT(`products`)": 50.0,
            "AVG(`products`.`price`)": 27.07,
            "MAX(`products`.`price`)": 310.0,
            "MIN(`products`.`price`)": 5.0,
            "COUNT_IF(`products`.`price`,>300)": 1.0
        },
        "sheet": {
            "A1": "=SUM(`products`.`price`)",
            "B1": "=SUM_IF(`products`.`price`,<100)/AVG(`products`.`price`)",
            "C2": "17",
            "C1": "=CELI(MAX(`products`.`price`)/2) + B1",
            "B5": "=MAX(`products`.`price`)/MIN(`products`.`price`)",
            "D1": "=MIN(`products`.`price`)",
            "A2": "=COUNT_IF(`products`.`price`,>300)"
        }
    }
\end{lstlisting}
\end{document}